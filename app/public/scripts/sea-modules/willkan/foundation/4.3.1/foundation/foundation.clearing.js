define("willkan/foundation/4.3.1/foundation/foundation.clearing",["willkan/foundation/4.3.1/foundation/foundation","$"],function(a){var b=window.Foundation||a("willkan/foundation/4.3.1/foundation/foundation");!function(a,c,d,e){"use strict";b.libs.clearing={name:"clearing",version:"4.3.1",settings:{templates:{viewing:'<a href="#" class="clearing-close">&times;</a><div class="visible-img" style="display: none"><img src="//:0"><p class="clearing-caption"></p><a href="#" class="clearing-main-prev"><span></span></a><a href="#" class="clearing-main-next"><span></span></a></div>'},close_selectors:".clearing-close",init:!1,locked:!1},init:function(c,d,e){var f=this;return b.inherit(this,"set_data get_data remove_data throttle data_options"),"object"==typeof d&&(e=a.extend(!0,this.settings,d)),"string"!=typeof d?(a(this.scope).find("ul[data-clearing]").each(function(){var b=a(this),c=c||{},d=b.find("li"),e=f.get_data(b);!e&&d.length>0&&(c.$parent=b.parent(),f.set_data(b,a.extend({},f.settings,c,f.data_options(b))),f.assemble(b.find("li")),f.settings.init||f.events().swipe_events())}),this.settings.init):this[d].call(this,e)},events:function(){var d=this;return a(this.scope).on("click.fndtn.clearing","ul[data-clearing] li",function(b,c,e){var c=c||a(this),e=e||c,f=c.next("li"),g=d.get_data(c.parent()),h=a(b.target);b.preventDefault(),g||d.init(),e.hasClass("visible")&&c[0]===e[0]&&f.length>0&&d.is_open(c)&&(e=f,h=e.find("img")),d.open(h,c,e),d.update_paddles(e)}).on("click.fndtn.clearing",".clearing-main-next",function(a){this.nav(a,"next")}.bind(this)).on("click.fndtn.clearing",".clearing-main-prev",function(a){this.nav(a,"prev")}.bind(this)).on("click.fndtn.clearing",this.settings.close_selectors,function(a){b.libs.clearing.close(a,this)}).on("keydown.fndtn.clearing",function(a){this.keydown(a)}.bind(this)),a(c).on("resize.fndtn.clearing",function(){this.resize()}.bind(this)),this.settings.init=!0,this},swipe_events:function(){var b=this;a(this.scope).on("touchstart.fndtn.clearing",".visible-img",function(b){b.touches||(b=b.originalEvent);var c={start_page_x:b.touches[0].pageX,start_page_y:b.touches[0].pageY,start_time:(new Date).getTime(),delta_x:0,is_scrolling:e};a(this).data("swipe-transition",c),b.stopPropagation()}).on("touchmove.fndtn.clearing",".visible-img",function(c){if(c.touches||(c=c.originalEvent),!(c.touches.length>1||c.scale&&1!==c.scale)){var d=a(this).data("swipe-transition");if("undefined"==typeof d&&(d={}),d.delta_x=c.touches[0].pageX-d.start_page_x,"undefined"==typeof d.is_scrolling&&(d.is_scrolling=!!(d.is_scrolling||Math.abs(d.delta_x)<Math.abs(c.touches[0].pageY-d.start_page_y))),!d.is_scrolling&&!d.active){c.preventDefault();var e=d.delta_x<0?"next":"prev";d.active=!0,b.nav(c,e)}}}).on("touchend.fndtn.clearing",".visible-img",function(b){a(this).data("swipe-transition",{}),b.stopPropagation()})},assemble:function(b){var c=b.parent();c.after('<div id="foundationClearingHolder"></div>');var d=a("#foundationClearingHolder"),e=this.get_data(c),f=c.detach(),g={grid:'<div class="carousel">'+this.outerHTML(f[0])+"</div>",viewing:e.templates.viewing},h='<div class="clearing-assembled"><div>'+g.viewing+g.grid+"</div></div>";return d.after(h).remove()},open:function(a,b,c){var d=c.closest(".clearing-assembled"),e=d.find("div").first(),f=e.find(".visible-img"),g=f.find("img").not(a);this.locked()||(g.attr("src",this.load(a)).css("visibility","hidden"),this.loaded(g,function(){g.css("visibility","visible"),d.addClass("clearing-blackout"),e.addClass("clearing-container"),f.show(),this.fix_height(c).caption(f.find(".clearing-caption"),a).center(g).shift(b,c,function(){c.siblings().removeClass("visible"),c.addClass("visible")})}.bind(this)))},close:function(b,c){b.preventDefault();var d,e,f=function(a){return/blackout/.test(a.selector)?a:a.closest(".clearing-blackout")}(a(c));return c===b.target&&f&&(d=f.find("div").first(),e=d.find(".visible-img"),this.settings.prev_index=0,f.find("ul[data-clearing]").attr("style","").closest(".clearing-blackout").removeClass("clearing-blackout"),d.removeClass("clearing-container"),e.hide()),!1},is_open:function(a){return a.parent().attr("style").length>0},keydown:function(b){var c=a(".clearing-blackout").find("ul[data-clearing]");39===b.which&&this.go(c,"next"),37===b.which&&this.go(c,"prev"),27===b.which&&a("a.clearing-close").trigger("click")},nav:function(b,c){var d=a(".clearing-blackout").find("ul[data-clearing]");b.preventDefault(),this.go(d,c)},resize:function(){var b=a(".clearing-blackout .visible-img").find("img");b.length&&this.center(b)},fix_height:function(b){var c=b.parent().children(),d=this;return c.each(function(){var b=a(this),c=b.find("img");b.height()>d.outerHeight(c)&&b.addClass("fix-height")}).closest("ul").width(100*c.length+"%"),this},update_paddles:function(a){var b=a.closest(".carousel").siblings(".visible-img");a.next().length>0?b.find(".clearing-main-next").removeClass("disabled"):b.find(".clearing-main-next").addClass("disabled"),a.prev().length>0?b.find(".clearing-main-prev").removeClass("disabled"):b.find(".clearing-main-prev").addClass("disabled")},center:function(a){return this.rtl?a.css({marginRight:-(this.outerWidth(a)/2),marginTop:-(this.outerHeight(a)/2)}):a.css({marginLeft:-(this.outerWidth(a)/2),marginTop:-(this.outerHeight(a)/2)}),this},load:function(a){if("A"===a[0].nodeName)var b=a.attr("href");else var b=a.parent().attr("href");return this.preload(a),b?b:a.attr("src")},preload:function(a){this.img(a.closest("li").next()).img(a.closest("li").prev())},loaded:function(a,b){function c(){b()}function d(){if(this.one("load",c),/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var a=this.attr("src"),b=a.match(/\?/)?"&":"?";b+="random="+(new Date).getTime(),this.attr("src",a+b)}}return a.attr("src")?(a[0].complete||4===a[0].readyState?c():d.call(a),void 0):(c(),void 0)},img:function(a){if(a.length){var b=new Image,c=a.find("a");b.src=c.length?c.attr("href"):a.find("img").attr("src")}return this},caption:function(a,b){var c=b.data("caption");return c?a.html(c).show():a.text("").hide(),this},go:function(a,b){var c=a.find(".visible"),d=c[b]();d.length&&d.find("img").trigger("click",[c,d])},shift:function(a,b,c){var d,e=b.parent(),f=this.settings.prev_index||b.index(),g=this.direction(e,a,b),h=parseInt(e.css("left"),10),i=this.outerWidth(b);b.index()===f||/skip/.test(g)?/skip/.test(g)&&(d=b.index()-this.settings.up_count,this.lock(),d>0?e.animate({left:-(d*i)},300,this.unlock()):e.animate({left:0},300,this.unlock())):/left/.test(g)?(this.lock(),e.animate({left:h+i},300,this.unlock())):/right/.test(g)&&(this.lock(),e.animate({left:h-i},300,this.unlock())),c()},direction:function(b,c,d){var e,f=b.find("li"),g=this.outerWidth(f)+this.outerWidth(f)/4,h=Math.floor(this.outerWidth(a(".clearing-container"))/g)-1,i=f.index(d);return this.settings.up_count=h,e=this.adjacent(this.settings.prev_index,i)?i>h&&i>this.settings.prev_index?"right":i>h-1&&i<=this.settings.prev_index?"left":!1:"skip",this.settings.prev_index=i,e},adjacent:function(a,b){for(var c=b+1;c>=b-1;c--)if(c===a)return!0;return!1},lock:function(){this.settings.locked=!0},unlock:function(){this.settings.locked=!1},locked:function(){return this.settings.locked},outerHTML:function(a){return a.outerHTML||(new XMLSerializer).serializeToString(a)},off:function(){a(this.scope).off(".fndtn.clearing"),a(c).off(".fndtn.clearing"),this.remove_data(),this.settings.init=!1},reflow:function(){this.init()}}}(b.zj,this,this.document)});
